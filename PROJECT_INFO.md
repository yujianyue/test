# PHP+MySQL 简易内部答题系统

## 项目概述

这是一个功能完整的PHP+MySQL答题系统，支持用户登录答题、管理员管理等功能。系统采用原生HTML5+CSS3+Ajax开发，界面简洁美观，适合手机访问。

## 技术栈

- **后端**: PHP 7+ with MySQLi
- **前端**: 原生 HTML5 + CSS3 + JavaScript (无第三方依赖)
- **数据库**: MySQL 5.6+
- **特性**: 响应式设计、验证码、加密存储、自动保存

## 功能特性

### 学生端 (Da.php)
- ✅ 用户登录/退出
- ✅ 输入考试ID开始答题
- ✅ 支持判断题、单选题、多选题
- ✅ 答题进度实时保存（Cookie）
- ✅ 定时自动提交（每3分钟）
- ✅ 答题时间限制
- ✅ 答题记录查看
- ✅ 修改密码

### 管理员端 (Ti.php)
- ✅ 管理员登录/退出
- ✅ 用户列表管理（CRUD）
- ✅ 批量导入用户
- ✅ 答题记录查看（详细答题情况）
- ✅ 答题数据下载（TSV格式）
- ✅ 统计分析
- ✅ 修改密码

## 计分方案

### 模式1: 答题模式1（全对得分）
- 判断题、单选题、多选题：全对得分，否则0分

### 模式2: 调查模式（顺序得分）
- 判断题、单选题：按选项顺序赋分（A=0, B=1, C=2...）
- 多选题：计算选中的选项个数

### 模式3: 答题模式2（混合计分）
- 判断题、单选题：全对得分，否则0分
- 多选题：逐项对比（正确个数 - 错误个数，最低0分）

## 文件结构

```
/workspace/
├── inc/                    # 公共文件目录
│   ├── conn.php           # 数据库配置
│   ├── pubs.php           # 公共PHP函数
│   ├── sqls.php           # 数据库操作类
│   ├── code.php           # 验证码生成
│   ├── pubs.js            # 公共JavaScript
│   ├── pubs.css           # 公共CSS样式
│   ├── head.php           # 公共头部
│   ├── foot.php           # 公共底部
│   └── json_user.php      # 管理员账号缓存
│
├── Ti/                     # 管理员功能模块
│   ├── login.php          # 登录
│   ├── lgout.php          # 退出
│   ├── ipass.php          # 修改密码
│   ├── iuser.php          # 用户列表
│   ├── iusin.php          # 用户导入
│   ├── ilist.php          # 答题记录
│   └── idown.php          # 数据下载
│
├── Da/                     # 学生答题模块
│   ├── login.php          # 登录
│   ├── lgout.php          # 退出
│   ├── ipass.php          # 修改密码
│   ├── index.php          # 考试ID输入
│   ├── idati.php          # 答题页面
│   └── ilist.php          # 答题记录
│
├── Ku/                     # 题库目录
│   ├── demo.json          # 演示试卷
│   ├── test1.json         # 计算机基础测试
│   └── survey.json        # 调查问卷
│
├── Ti.php                  # 管理员入口
├── Da.php                  # 学生入口
├── install.php             # 安装程序
├── readme.txt             # 详细说明文档
└── PROJECT_INFO.md        # 项目信息
```

## 安装步骤

1. **配置数据库**
   ```bash
   修改 inc/conn.php 中的数据库连接信息
   ```

2. **运行安装程序**
   ```
   访问: http://your-domain/install.php
   ```

3. **使用默认账号登录**
   - 管理员: admin / 123456
   - 学生: S0001~S0036 / 123456

## 数据库表结构

### user 表（用户表）
| 字段 | 类型 | 说明 |
|------|------|------|
| id | BIGINT | 主键ID |
| usid | VARCHAR(50) | 学号（唯一） |
| name | VARCHAR(100) | 姓名 |
| pass | VARCHAR(255) | 密码（加密） |
| ctime | DATETIME | 添加时间 |
| utime | DATETIME | 修改时间 |

### recs 表（答题记录表）
| 字段 | 类型 | 说明 |
|------|------|------|
| id | BIGINT | 主键ID |
| ename | VARCHAR(200) | 考试名称 |
| epath | TEXT | 试题路径 |
| ptime | DATETIME | 路径修改时间 |
| usid | VARCHAR(50) | 学号 |
| stime | DATETIME | 开始时间 |
| ltime | DATETIME | 最后时间 |
| idati | TEXT | 答题记录（JSON） |
| jifen | TEXT | 计分明细（JSON） |
| score | DECIMAL(5,2) | 得分 |
| ipadd | VARCHAR(45) | IP地址 |

## 题库格式

题库文件采用JSON格式，存放在 `Ku/` 目录：

```json
{
    "name": "考试名称",
    "mode": 1,
    "time_limit": 30,
    "description": "考试说明",
    "questions": {
        "q1": {
            "type": "tf",
            "title": "题目内容",
            "options": ["选项A", "选项B"],
            "answer": "A",
            "score": 10
        }
    }
}
```

### 题目类型
- `tf`: 判断题（True/False）
- `single`: 单选题
- `multi`: 多选题

## 核心功能实现

### 答题进度保存
- Cookie本地缓存
- 每3分钟自动提交到服务器
- 刷新页面自动恢复进度

### 安全特性
- 密码加盐MD5加密
- SQL注入防护
- XSS攻击防护
- 登录验证码
- Session超时控制

### 响应式设计
- 移动端优先
- 触摸友好
- 自适应布局

## 使用说明

### 管理员操作
1. 访问 `Ti.php` 登录管理后台
2. 在"用户列表"中管理学生账号
3. 在"用户导入"中批量导入学生
4. 在"答题记录"中查看答题情况
5. 在"数据下载"中导出统计数据

### 学生操作
1. 访问 `Da.php` 登录系统
2. 输入考试ID（如：demo）
3. 开始答题
4. 系统自动保存进度
5. 完成后点击"完成答题"提交

### 添加题库
1. 在 `Ku/` 目录创建JSON文件
2. 按照格式编写题目
3. 文件名即为考试ID

## 注意事项

⚠️ **重要提示**
- 首次使用请修改默认管理员密码
- 题库JSON格式必须正确
- 定期备份数据库
- 建议使用HTTPS部署

## 技术亮点

✨ **无依赖**
- 不依赖任何第三方库
- 纯原生PHP+JavaScript实现

✨ **高性能**
- 题库JSON缓存
- 分页查询
- Ajax异步通信

✨ **易扩展**
- 模块化设计
- 代码注释完整
- 便于二次开发

## 作者信息

- **联系方式**: 15058593138@qq.com（手机号同微信）
- **版本**: 1.0.0
- **开发时间**: 2024年11月

## 许可证

本项目仅供学习和内部使用。

---

**更多详细信息请参阅 `readme.txt` 文件**
